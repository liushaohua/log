!function(){var params={},args="",load_time={date:new Date,start:(new Date).getTime()};if(document){params.d=window.location.host||"",params.url=document.URL||"";var ref=(document.referrer||"").split("/"),ref_arr=[],rd=ref_arr.concat(ref[0],ref[1],ref[2]).join("/");params.rd="//"==rd?"":rd,params.rd=params.rd.replace("http://","").replace("https://","")}if(window&&window.screen&&(params.sh=window.screen.height||0,params.sw=window.screen.width||0),window._maq)for(var i in _maq)switch(_maq[i][0]){case"_setAccount":params.account=_maq[i][1]}var _util={isNew:0,dom:{$:function(e,t){t=t||document;for(var i=[],o=t.getElementsByTagName("*"),a=new RegExp("\\b"+e+"\\b","i"),n=0,r=o.length;r>n;n++)a.test(o[n].className)&&i.push(o[n]);return i},hasClass:function(e,t){var i=new RegExp("\\b"+e+"\\b","i");return i.test(t.className)?!0:!1}},addEventHandler:function(e,t,i){document.addEventListener?e.addEventListener(t,i,!1):document.attachEvent?e.attachEvent("on"+t,i):e["on"+t]=i},getCookie:function(e){var t=encodeURIComponent(e)+"=",i=document.cookie.indexOf(t),o=null;if(i>-1){var a=document.cookie.indexOf(";",i);-1==a&&(a=document.cookie.length),o=decodeURIComponent(escape(document.cookie.substring(i+t.length,a)))}return o},setCookie:function(e,t,i,o,a,n){var r=encodeURIComponent(e)+"="+encodeURIComponent(t),u=new Date;return u.setTime("day"==i.type?u.getTime()+864e5*i.value:u.getTime()+60*i.value*1e3),u instanceof Date&&(r+="; expires="+u.toGMTString()),o&&(r+="; path="+o),n&&(r+="; secure"),e&&(r+="; domain=."+window.location.hostname+"; path=/"),document.cookie=r,this},removeCookie:function(e,t,i,o){this.setCookie(e,"",{type:"minute",value:0},t,i,o)},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)})},setConsole:function(){window.__session=_util.getCookie("UUID").split(".").join("|")},getNowFormatDate:function(e){var t=e||new Date,i="-",o=":",a=t.getMonth()+1,n=t.getDate(),r=t.getSeconds(),u=function(e){return 10>e?"0"+e:e};a>=1&&9>=a&&(a="0"+a),n>=0&&9>=n&&(n="0"+n);var s=t.getFullYear()+i+a+i+n+" "+u(t.getHours())+o+u(t.getMinutes())+o+u(r);return s},logInputFn:function(){for(var aInput=document.getElementsByTagName("input"),_this=this,i=0,l=aInput.length;l>i;i++){var oInput=aInput[i];oInput.getAttribute("dc")&&(oInput.onblur=function(){var dc=eval("("+this.getAttribute("dc")+")");dc.value=this.value,_this.sendLog("blur",dc)})}},logBtnFn:function(){var _this=this;_this.addEventHandler(document,"click",function(ev){var ev=ev||window.event,target=ev.srcElement||ev.target;target.getAttribute("dc")&&_this.sendLog("click",eval("("+target.getAttribute("dc")+")"))}),setTimeout(function(){window.__MisLog=_this.sendLog},50)},put_img:function(e){e=e||{},e.pid=_util.pid;var t="";for(var i in e)""!=t&&(t+="&"),t+=i+"="+encodeURIComponent(e[i]);if(_util.isLoad&&(delete params.sh,delete params.sw,delete params.domain,_util.isLoad=0),1==+_util.getCookie("STEP")){var o=params.rd.replace("http://","").replace("https://","")||"";_util.setCookie("VD",o,{type:"day",value:180}),params.vd=o}else params.vd=_util.getCookie("VD")||"";for(var i in params)""!=t&&(t+="&"),t+=i+"="+encodeURIComponent(params[i]);_util.isLoad=1;var a=new Image(1,1);a.src="http://testlog.58corp.com/1.gif?"+t},sendLog:function(type,param){var _this=this;if(param=param||{},/([0-9]{1,3}\.{1}){3}[0-9]{1,3}/.test(document.domain))return!1;if(_util.getCookie("UUID")&&(param.uuid=_util.getCookie("UUID").split(".")[0]),0==arguments.length)type=type||"view";else if("object"==typeof arguments[0])return void _util.put_img(eval("("+arguments[0].getAttribute("dc")+")"));if("time"==type){load_time.end=(new Date).getTime();var difference=load_time.end-load_time.start;param.lt=difference,param.st=_util.getNowFormatDate(load_time.date),_this.put_img(param)}else if("unload"==type)param.st=_util.getNowFormatDate(load_time.date),param.et=_util.getNowFormatDate(new Date),_this.put_img(param);else if("click"==type||"blur"==type)_this.put_img(param);else{if(_util.getCookie("UUID"))_util.setCookie("UUID",_util.getCookie("UUID"),{type:"day",value:180}),_util.getCookie("STEP")?_util.setCookie("STEP",+_util.getCookie("STEP")+1,{type:"minute",value:30}):(_util.setCookie("UUID",_util.getCookie("UUID").split(".")[0]+"."+(+_util.getCookie("UUID").split(".")[1]+1),{type:"day",value:180}),_util.setCookie("STEP",1,{type:"minute",value:30}));else{var _uuid=_this.guid()+".1";_util.isNew=1,_util.setCookie("UUID",_uuid,{type:"day",value:180}),_util.setCookie("STEP",1,{type:"minute",value:30}),this.setConsole()}_util.pid=_util.getCookie("UUID").split(".")[0]+(new Date).getTime(),_this.put_img({uuid:_util.getCookie("UUID").split(".")[0],sid:_util.getCookie("UUID").split(".").join("|"),st:_util.getNowFormatDate(load_time.date),v:+_util.getCookie("UUID").split(".")[1],s:_util.getCookie("STEP"),nu:_util.isNew},1)}}};_util.sendLog(),_util.addEventHandler(window,"load",function(){_util.sendLog("time"),_util.logBtnFn(),_util.logInputFn()})}();